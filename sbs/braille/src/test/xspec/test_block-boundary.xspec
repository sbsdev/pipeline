<?xml version="1.0" encoding="utf-8"?>
<x:description xmlns:x="http://www.jenitennison.com/xslt/xspec"
	       xmlns:dtb="http://www.daisy.org/z3986/2005/dtbook/"
	       xmlns:brl="http://www.daisy.org/z3986/2009/braille/"
               stylesheet="../resources/block-translate.xsl"
	       preserve-space="dtb:p dtb:byline dtb:author dtb:li dtb:lic dtb:doctitle dtb:docauthor dtb:span dtb:em dtb:strong brl:emph dtb:line dtb:h1 dtb:h2 dtb:h3 dtb:h4 dtb:h5 dtb:h6">

  <x:param name="contraction-grade">2</x:param>
  <x:param name="ascii-braille">yes</x:param>

    <x:scenario label="context across block boundaries Bug #1395 with em before">
      <x:context>
        <stub xml:lang="de"><dtb:byline><dtb:em>Tages-Anzeiger</dtb:em></dtb:byline>
          <dtb:p>Zum Autor</dtb:p></stub>
      </x:context>
      <x:expect label="braille">
        <stub xml:lang="de">
	  <dtb:byline><dtb:em>__TAG%-+Z3G7'.</dtb:em></dtb:byline>
          <dtb:p>ZM 1TOR</dtb:p>
	</stub>
      </x:expect>
    </x:scenario>

    <x:scenario label="context across block boundaries Bug #1395 with em after">
      <x:context>
        <stub xml:lang="de"><dtb:byline>Tages-Anzeiger</dtb:byline><dtb:p><dtb:em>Zum Autor</dtb:em></dtb:p></stub>
      </x:context>
      <x:expect label="braille">
        <stub xml:lang="de">
	  <dtb:byline>TAG%-+Z3G7</dtb:byline><dtb:p><dtb:em>__ZM 1TOR'.</dtb:em></dtb:p>
	</stub>
      </x:expect>
    </x:scenario>

    <x:scenario label="context across block boundaries Bug #1395 with em both">
      <x:context>
        <stub xml:lang="de"><dtb:byline><dtb:em>Tages-Anzeiger</dtb:em></dtb:byline>
          <dtb:p><dtb:em>Zum Autor</dtb:em></dtb:p></stub>
      </x:context>
      <x:expect label="braille">
        <stub xml:lang="de">
	  <dtb:byline><dtb:em>__TAG%-+Z3G7'.</dtb:em></dtb:byline>
          <dtb:p><dtb:em>__ZM 1TOR'.</dtb:em></dtb:p>
	</stub>
      </x:expect>
    </x:scenario>

    <x:scenario label="context across block boundaries Bug #1395">
      <x:context>
        <stub xml:lang="de"><dtb:byline>Tages-Anzeiger</dtb:byline>
          <dtb:p>Zum Autor</dtb:p></stub>
      </x:context>
      <x:expect label="braille">
        <stub xml:lang="de">
	  <dtb:byline>TAG%-+Z3G7</dtb:byline>
          <dtb:p>ZM 1TOR</dtb:p>
	</stub>
      </x:expect>
    </x:scenario>

    <x:scenario label="Context across text nodes ending with punctuation ">
      <x:context>
        <stub xml:lang="de">»<dtb:span>Tages-Anzeiger.</dtb:span>« Zum Autor</stub>
      </x:context>
      <x:expect label="braille">
        <stub xml:lang="de">(<dtb:span>TAG%-+Z3G7.</dtb:span>) ZM 1TOR</stub>
      </x:expect>
    </x:scenario>

    <x:scenario label="Context across block boundaries ending with punctuation ">
      <x:context>
        <stub xml:lang="de">»Tages-Anzeiger.<dtb:p>« Zum Autor</dtb:p></stub>
      </x:context>
      <x:expect label="braille">
	<stub xml:lang="de">(TAG%-+Z3G7.<dtb:p>) ZM 1TOR</dtb:p></stub>
      </x:expect>
    </x:scenario>

    <x:scenario label="Another weird context problem">
      <x:context>
        <dtb:p xml:lang="de"><dtb:em>Mist</dtb:em>, dachte er, <dtb:em>wie komme ich hier raus?</dtb:em></dtb:p>
      </x:context>
      <x:expect label="braille">
        <dtb:p xml:lang="de"><dtb:em>_MI]</dtb:em>, D&lt;( 7, <dtb:em>__2 KXE # HR R1S?'.</dtb:em></dtb:p>
      </x:expect>
    </x:scenario>

    <x:scenario label="Text matcher inside block, h1"
		pending="the apo needs to be moved out of the abbr">
      <x:context>
	<dtb:h1 xml:lang="de"><dtb:abbr>ABC</dtb:abbr>s</dtb:h1>
      </x:context>
      <x:expect label="braille">
	<dtb:h1 xml:lang="de"><dtb:abbr>&gt;ABC</dtb:abbr>'S</dtb:h1>
      </x:expect>
    </x:scenario>

    <x:scenario label="Text matcher inside block, p"
		pending="the apo needs to be moved out of the abbr">
      <x:context>
	<dtb:p xml:lang="de"><dtb:abbr>ABC</dtb:abbr>s</dtb:p>
      </x:context>
      <x:expect label="braille">
	<dtb:p xml:lang="de"><dtb:abbr>&gt;ABC</dtb:abbr>'S</dtb:p>
      </x:expect>
    </x:scenario>

    <x:scenario label="Text matcher inside block, bridgehead"
		pending="the apo needs to be moved out of the abbr">
      <x:context>
        <dtb:bridgehead xml:lang="de"><dtb:abbr>ABC</dtb:abbr>s</dtb:bridgehead>
      </x:context>
      <x:expect label="braille">
	<dtb:bridgehead xml:lang="de"><dtb:abbr>&gt;ABC</dtb:abbr>'S</dtb:bridgehead>
      </x:expect>
    </x:scenario>

    <x:scenario label="Text matcher inside block, hd"
		pending="the apo needs to be moved out of the abbr">
      <x:context>
        <dtb:hd xml:lang="de"><dtb:abbr>ABC</dtb:abbr>s</dtb:hd>
      </x:context>
      <x:expect label="braille">
	<dtb:hd xml:lang="de"><dtb:abbr>&gt;ABC</dtb:abbr>'S</dtb:hd>
      </x:expect>
    </x:scenario>

    <x:scenario label="Text matcher inside block, dd and dt"
		pending="the apo needs to be moved out of the abbr">
      <x:context>
        <dtb:dd xml:lang="de"><dtb:abbr>ABC</dtb:abbr>s</dtb:dd>
        <dtb:dt xml:lang="de"><dtb:abbr>ABC</dtb:abbr>s</dtb:dt>
      </x:context>
      <x:expect label="braille">
        <dtb:dd xml:lang="de"><dtb:abbr>&gt;ABC</dtb:abbr>'S</dtb:dd>
        <dtb:dt xml:lang="de"><dtb:abbr>&gt;ABC</dtb:abbr>'S</dtb:dt>
      </x:expect>
    </x:scenario>

    <x:scenario label="Text matcher inside block, caption, th and td"
		pending="the apo needs to be moved out of the abbr">
      <x:context>
	<dtb:caption xml:lang="de"><dtb:abbr>ABC</dtb:abbr>s</dtb:caption>
      </x:context>
      <x:expect label="braille">
	<dtb:caption xml:lang="de"><dtb:abbr>&gt;ABC</dtb:abbr>'S</dtb:caption>
      </x:expect>
    </x:scenario>

    <x:scenario label="Text matcher inside block, th and td"
		pending="the apo needs to be moved out of the abbr">
      <x:context>
	<dtb:th xml:lang="de"><dtb:abbr>ABC</dtb:abbr>s</dtb:th>
        <dtb:td xml:lang="de"><dtb:abbr>ABC</dtb:abbr>s</dtb:td>
      </x:context>
      <x:expect label="braille">
	<dtb:th xml:lang="de"><dtb:abbr>&gt;ABC</dtb:abbr>'S</dtb:th>
        <dtb:td xml:lang="de"><dtb:abbr>&gt;ABC</dtb:abbr>'S</dtb:td>
      </x:expect>
    </x:scenario>

</x:description>
